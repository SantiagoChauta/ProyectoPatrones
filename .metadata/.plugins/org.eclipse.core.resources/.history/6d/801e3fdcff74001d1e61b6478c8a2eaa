package com.cliente.implementaciones;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import com.cliente.Tablas.Pedido;
import com.cliente.conexion.Conexion;



public class PedidoDAOImp {
	PreparedStatement ps;
    ResultSet rs;
    Conexion c = new Conexion();
    Connection con;
    
	public List listar(){
        List<Pedido> lista = new ArrayList();
        String sql = "select * from pedido";
        
        try{
            con =c.conectar();
            ps = con.prepareStatement(sql);
            rs = ps.executeQuery();
            
            while(rs.next()){
                Pedido em = new Pedido();
                em.setId(rs.getInt(1));
                em.setCliente_id(rs.getString(2));
                em.setProducto(rs.getString(3));
                em.setPrecio(rs.getFloat(4));
                em.setCantidad(rs.getInt(5));;
                lista.add(em);
            }
            rs.close();
            
        }catch(Exception e){
            System.out.println("Fallo sacara los datos de las columnas");
        }
        return lista;
    }
}
